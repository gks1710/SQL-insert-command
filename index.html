<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GKS - MySQL INSERT Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #333;
        }
        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        input[type="text"], textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            resize: vertical;
            min-height: 150px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
            margin-right: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .output-container {
            position: relative;
            margin-top: 20px;
        }
        .copy-button {
            background-color: #28a745;
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
        .copy-button:hover {
            background-color: #1e7e34;
        }
        pre {
            background-color: #eee;
            padding: 15px;
            border-radius: 4px;
            white-space: pre-wrap;
            word-wrap: break-word;
            border: 1px solid #ccc;
            margin-top: 10px;
            text-transform: lowercase; 
        }
    </style>
</head>
<body>

<div class="container">
    <h2>GKS - MySQL INSERT Statement Generator</h2>
    <p>ðŸ’¡ **Note:** The final output SQL command is generated in **lowercase**.</p>

    <label for="tableName">Table Name:</label>
    <input type="text" id="tableName" value="finolex_products" placeholder="e.g., finolex_products">

    <label for="columnNames">Column Names (comma separated):</label>
    <input type="text" id="columnNames" value="" placeholder="e.g., col1,col2,col3,...">

    <label for="dataInput">Data (CSV format - header row first, followed by data rows):</label>
    <textarea id="dataInput" placeholder="Copy and paste your data here. The first row should match the column names."
>data11,data12,data13,data14,....
data21,data22,data23,data24,....
data31,data32,data33,data34,....
</textarea>

    <button onclick="generateSql()">Generate SQL</button>

    <div class="output-container">
        <label for="sqlOutput">Generated MySQL INSERT Command:</label>
        <button class="copy-button" onclick="copySql()">Copy SQL Command</button>
        <pre id="sqlOutput"></pre>
    </div>
</div>

<script>
function generateSql() {
    const tableName = document.getElementById('tableName').value.trim();
    const columnNamesInput = document.getElementById('columnNames').value.trim();
    const dataInput = document.getElementById('dataInput').value.trim();
    const outputElement = document.getElementById('sqlOutput');

    if (!tableName || !columnNamesInput || !dataInput) {
        outputElement.textContent = "error: please fill in all fields.";
        return;
    }

    const columnNames = columnNamesInput.split(',').map(col => col.trim()).filter(col => col.length > 0);
    if (columnNames.length === 0) {
        outputElement.textContent = "error: please provide valid column names.";
        return;
    }

    const dataRows = dataInput.split('\n').map(row => row.trim()).filter(row => row.length > 0);
    let valuesClauses = [];

    for (let i = 0; i < dataRows.length; i++) {
        const row = dataRows[i];

        // Skip the header row if it matches the column names provided
        const inputHeader = columnNamesInput.toLowerCase().replace(/ /g, '');
        const dataRowNormalized = row.toLowerCase().replace(/ /g, '');

        if (i === 0 && dataRowNormalized === inputHeader) {
             continue;
        }

        const values = row.split(',');

        if (values.length !== columnNames.length) {
            outputElement.textContent = `error on row ${i + 1}: expected ${columnNames.length} columns, but found ${values.length}. row: ${row}`;
            return;
        }

        const formattedValues = values.map(val => {
            let trimmedVal = val.trim();
            // Keep pure numbers unquoted
            if (!isNaN(parseFloat(trimmedVal)) && isFinite(trimmedVal) && trimmedVal !== '') {
                return trimmedVal;
            } else {
                // Escape single quotes and enclose in single quotes for strings
                return `'${trimmedVal.replace(/'/g, "''")}'`;
            }
        });
        valuesClauses.push(`(${formattedValues.join(', ')})`);
    }

    if (valuesClauses.length === 0) {
        outputElement.textContent = "error: no valid data rows found after the header.";
        return;
    }

    const columnsSql = `(${columnNames.join(', ')})`;
    const valuesSql = valuesClauses.join(',\n');

    let fullSql = `INSERT INTO ${tableName} ${columnsSql} VALUES\n${valuesSql};`;
    
    // Convert the entire SQL command to lowercase
    fullSql = fullSql.toLowerCase();

    outputElement.textContent = fullSql;
}

function copySql() {
    const sqlOutput = document.getElementById('sqlOutput').textContent;
    if (sqlOutput.startsWith('error') || sqlOutput === "") {
        alert("Cannot copy. No valid SQL generated yet.");
        return;
    }
    
    // Use the modern clipboard API
    navigator.clipboard.writeText(sqlOutput).then(() => {
        alert("SQL command copied to clipboard!");
    }).catch(err => {
        // Fallback for older browsers
        console.error('Could not copy text: ', err);
        alert('Failed to copy. Please manually select and copy the text.');
    });
}

// Generate the SQL on load to show a default state
window.onload = generateSql;
</script>

</body>
</html>
